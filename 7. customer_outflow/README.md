# Проект 7 (Обучение с учителем). Прогнозирование оттока клиента Банка

### Описание проекта

Из банка стали уходить клиенты. Каждый месяц. Немного, но заметно. Банковские маркетологи посчитали: сохранять текущих клиентов дешевле, чем привлекать новых.
Нужно спрогнозировать, уйдёт клиент из банка в ближайшее время или нет. Предоставлены исторические данные о поведении клиентов и расторжении договоров с банком.

### Задачи проекта

На основе данных из банка определить клиент, который может уйти

### Итоги

на первом этапе проведена подготовка данных:
с помощью матрицы phik провеедена оценка мультиколлинерности категориальных и количнственных признаков на начальном этапе и после формирования обучающей выборки;
удалены столбцы с неинформативными. признаками;
данные разделены по целевому и нецелевому признакам и затем на обучающий, валидационный и тестовый наборы выборок;
выполнено кодирование категориальных нецелевых признаков методом OHE;
заполнены пропуски в столбце Tenure с помощью модели NeiboursClassifier;
после масштабированы все числовые признаки и сформированы итоговые выборки нецелевых признаков.

На втором этапе:
в ходе исследования баланса классов выявлен дисбаланс 4:1;
исследованы модели с дисбалансом (решающее дерево, случайный лес и логрессия), лучший результат достигнут с помощью алгоритма gridsearchCV - это модель RandomForestClassifier(max_depth=13, n_estimators=50, random_state=12345), метрика f1 =0.58.

На третьем этапе исследованы методы борьбы с дисбалансом классов:
использовались три способа: взвешивание классов - задание гиперпараметра class_weight='balanced', семплинг upsampling и downsampling и изменение порога;
использование взвешивания и семплинга одновременно не приводило к улучшению метрики f1. Существенное влияние на значение метрики f1 оказывал непосредственно выбор самой модели;
выбрана модель случайного леса: RandomForestClassifier(random_state=12345, max_depth=13, n_estimators=90) со взвешиванием классов и порогом 0.5. Значение f1-меры = 0.6. Значение AUC-ROC = 0.85.
значение AUC-ROC не зависит от техник исправления дисбаланса. Функция AUC-ROC устроена не в виде суммы ошибок на объектах, а в виде суммы ошибок на парах объектов разных классов. При любой балансировке показатели TPR и FPR будут сохраняться примерно теми же.

На четвертом этапе проводилось тестирование выбранной модели
тестирование модели RandomForestClassifier(random_state=12345, max_depth=13, n_estimators=90) с upsampling и порогом 0.5 показало более лучший результат по сравнению с валидационной выборкой: f1 = 0.63 против f1 = 0.6.

В ходе исследования выбрана модель прогнозирования оттока клиентов банка RandomForestClassifier(random_state=12345, max_depth=13, n_estimators=90) с upsampling и порогом 0.5 с метрикой f1 = 0.63.

### Направление деятельности

- Машинное обучение
- Классификация

### Сферы деятельности

- Бизнес
- Инвестиции
- Банковская сфера
- Кредитование

### Навыки и инструменты

- pandas
- Matplotlib
- Scikit-learn

### Ключевые слова

- классификация 
- подбор гиперпараметров
- выбор модели МО





